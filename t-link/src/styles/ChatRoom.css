/* --- โครงสร้างหลัก --- */
html, body {
  margin: 0; padding: 0; height: 100%; overflow: hidden;
}
* { box-sizing: border-box; }

.chat-room-container {
  display: flex; flex-direction: column; height: 100vh;
  width: 100%; max-width: 500px; margin: 0 auto;
  position: relative; background-color: #e5ddd5;
  background-image: url('https://user-images.githubusercontent.com/15075759/28719144-86dc0f70-73b1-11e7-911d-60d70fcded21.png');
  overflow: hidden;
}

.home-header {
  background-color: #212121; height: 70px; color: #d4af37;
  padding: 0 15px; display: flex; align-items: center; flex-shrink: 0;
  z-index: 20;
}

.messages-area {
  flex: 1; overflow-y: auto; padding: 15px;
  display: flex; flex-direction: column; gap: 8px;
}

/* --- Message Bubbles --- */
.message-wrapper { display: flex; flex-direction: column; width: 100%; }

.message-bubble {
  max-width: 85%; 
  padding: 8px 12px; 
  border-radius: 15px;
  position: relative;
  margin-bottom: 4px; font-size: 1.1rem; line-height: 1.4;
  display: flex; flex-direction: column;
}
.message-content-wrapper {
  display: block; /* ใช้ block เพื่อให้ span และ div ภายในไหลตามกัน */
  word-wrap: break-word;
  line-height: 1.4;
}

.message-bubble.me { background-color: #f0d271; align-self: flex-end; border-bottom-right-radius: 2px; }
.message-bubble.friend { background-color: white; align-self: flex-start; border-bottom-left-radius: 2px; }

.message-text {
  display: inline; /* ✅ สำคัญ: เพื่อให้ธาตุถัดไปมาต่อท้ายได้ */
  word-break: break-word;
  font-size: 1rem;
  color: #000;
}

.message-time {
  display: inline-flex; /* ใช้ inline-flex เพื่อให้ต่อท้ายข้อความได้ */
  align-items: center;
  font-size: 0.8rem;
  color: #888;
  margin-left: 8px; /* ระยะห่างจากข้อความ */
  vertical-align: bottom; /* ให้ชิดด้านล่าง */
  position: relative;
  top: 6px; /* ขยับลงมานิดหน่อยให้ดูสมดุล */
  float: right; /* ✅ เทคนิคทำให้เวลาไปอยู่มุมขวาล่างของข้อความสุดท้าย */
}
.message-content-wrapper::after {
  content: "";
  display: table;
  clear: both;
}
.message-bubble.me .message-time {
  color: #756000;
}

/* --- Reply ใน Bubble --- */
.reply-preview-in-bubble {
  background-color: rgb(241, 187, 40); border-left: 5px solid #c59906;
  padding: 5px 8px; border-radius: 5px; margin-bottom: 6px; font-size: 0.85rem;
}
.reply-preview-in-bubble small { font-weight: bold; color: #000000; display: block; }
.text-truncate { overflow: hidden; text-overflow: ellipsis; white-space: nowrap; max-width: 150px; color: #555; }

.message-bubble.friend .reply-preview-in-bubble {
    background-color: rgba(0, 0, 0, 0.05); /* พื้นหลังเทาจางๆ */
    border-left: 3px solid #ccc;           /* เส้นคั่นด้านข้างสีเทา */
    padding: 5px;
    border-radius: 4px;
    margin-bottom: 5px;
}

/* --- ✅ Reply Bar (อยู่เหนือช่องพิมพ์) --- */
.reply-bar {
  background-color: #ffffff;
  padding: 10px 20px;
  border-left: 5px solid #d4af37;
  border-top: 1px solid #ddd;
  display: flex; align-items: center; justify-content: space-between;
  animation: slideIn 0.2s ease-out;
  flex-shrink: 0;
}
.reply-content span { font-size: 0.8rem; font-weight: bold; color: #d4af37; display: block; }
.reply-content p { margin: 0; font-size: 0.9rem; color: #666; overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }

.close-reply-btn { background: none; border: none; font-size: 1.2rem; color: #999; cursor: pointer; }

/* --- Input Area --- */
.chat-input-area {
  display: flex; align-items: center; gap: 10px; padding: 12px 15px;
  background-color: #ffffff; border-top: 1px solid #e0e0e0; flex-shrink: 0;
  padding-bottom: calc(12px + env(safe-area-inset-bottom));
}

.large-input {
  flex: 1; padding: 12px 18px; border-radius: 25px; border: 1px solid #dcdcdc;
  font-size: 16px; outline: none; background-color: #f9f9f9;
}

.send-btn-large {
  background: #d4af37; color: white; border: none; width: 45px; height: 45px;
  border-radius: 50%; cursor: pointer; font-size: 20px; flex-shrink: 0;
}

/* --- Checkmarks --- */
.checkmark-container { display: flex; position: relative; width: 15px; height: 14px; margin-bottom: 8px; }
.checkmark-container.read { color: #977507; }
.check-1 { 
  position: absolute; 
  font-size: 14px;
  left: 3px; }
.check-2 { 
  position: absolute; 
  font-size: 14px;
  left: 8px; }

@keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }